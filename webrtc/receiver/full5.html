<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Baby Monitor â€“ Receiver (Menu Only)</title>
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover"/>
  <style>
    :root { color-scheme: dark; --ui-pad: 12px; }

    html, body {
      margin: 0; height: 100%;
      background: #000; color: #fff;
      font-family: -apple-system, system-ui, Segoe UI, Roboto, sans-serif;
      overflow: hidden;
    }

    /* ---------- Left Sidebar (auto-hide) ---------- */
    #sidebar {
      position: fixed; top: 0; bottom: 0; left: 0;

      /* Fit to content width, but never exceed 80vw; ensure a small minimum */
      width: max-content;
      width: fit-content;
      max-width: 80vw;
      min-width: 150px;

      background: rgba(0,0,0,0.92);
      border-right: 1px solid rgba(255,255,255,0.1);
      backdrop-filter: blur(2px);
      box-shadow: 6px 0 24px rgba(0,0,0,0.5);
      transform: translateX(-100%);
      transition: transform .25s ease;
      z-index: 20;
      display: flex; flex-direction: column;
      cursor: default;
      user-select: none;
      -webkit-user-select: none;
      touch-action: auto;
    }
    #sidebar.visible { transform: translateX(0); }

    #sidebar .menu {
      padding: 8px;
      overflow-y: auto; -webkit-overflow-scrolling: touch;

      /* Hide scrollbar across browsers (still scrolls) */
      scrollbar-width: none;              /* Firefox */
      -ms-overflow-style: none;           /* IE/Edge legacy */
    }
    #sidebar .menu::-webkit-scrollbar {   /* WebKit */
      width: 0; height: 0;
    }

    #sidebar .nav-item {
      all: unset;
      display: flex; align-items: center; gap: 10px;
      width: 100%;
      padding: 12px 14px; margin: 2px 0;
      border-radius: 10px; cursor: pointer; user-select: none;
      color: #eee; font-weight: 600; font-size: 15px;
      white-space: nowrap; /* keep one line so width hugs the text */
    }
    #sidebar .nav-item:hover { background: rgba(255,255,255,0.08); }
    #sidebar .nav-item.active { background: rgba(255,255,255,0.14); }

    .nav-icon {
      width: 18px; height: 18px; flex: 0 0 18px;
      stroke: currentColor; fill: none; opacity: 0.9;
    }

    /* ---------- Tiny Hamburger Button (hides when drawer open) ---------- */
    #hamburger {
      position: fixed;
      top: 12px; left: 12px;
      top: calc(12px + env(safe-area-inset-top));
      left: calc(12px + env(safe-area-inset-left));

      width: 38px; height: 38px; padding: 8px;
      display: flex; align-items: center; justify-content: center;
      border-radius: 10px; border: 1px solid rgba(255,255,255,0.25);
      background: rgba(0,0,0,0.7);
      color: #fff;
      cursor: pointer; z-index: 30; user-select: none;
      -webkit-tap-highlight-color: transparent;
      -webkit-appearance: none; appearance: none;
      transition: opacity .25s ease, background .2s ease;
      box-shadow: 0 2px 10px rgba(0,0,0,.35);
    }
    #hamburger svg { width: 100%; height: 100%; display: block; }
    #hamburger svg path { stroke: currentColor; stroke-width: 2.2; stroke-linecap: round; fill: none; }
    #hamburger[aria-expanded="true"] { background: rgba(255,255,255,0.1); }
    #hamburger.faded { opacity: 0; pointer-events: none; }
    #hamburger.hidden { display: none; }

    /* ---------- Invite QR modal ---------- */
    #qrModal {
      position: fixed; inset: 0;
      display: none; align-items: center; justify-content: center;
      background: rgba(0,0,0,0.6);
      backdrop-filter: blur(2px);
      z-index: 40;
    }
    #qrModal.visible { display: flex; }
    .qr-card {
      position: relative;
      width: min(92vw, 420px);
      background: #0b0b0b;
      border: 1px solid rgba(255,255,255,0.12);
      border-radius: 16px;
      padding: 16px;
      text-align: center;
      color: #eee;
      box-shadow: 0 10px 30px rgba(0,0,0,0.5);
    }
    .qr-title { margin: 0 0 8px 0; font-size: 18px; font-weight: 700; }
    .qr-sub { margin: 0 0 12px 0; font-size: 14px; opacity: 0.8; }
    #qrContainer {
      display: inline-block; background: #fff; padding: 10px; border-radius: 12px;
      margin: 8px auto 12px auto;
    }
    .qr-actions {
      display: flex; gap: 8px; justify-content: center; flex-wrap: wrap;
    }
    .qr-actions button, .qr-actions a {
      all: unset;
      padding: 10px 12px; border-radius: 10px; cursor: pointer;
      background: #1e1e1e; color: #fff; border: 1px solid rgba(255,255,255,0.18);
      font-weight: 600; font-size: 14px;
    }
    .qr-actions a { text-decoration: none; }
    .qr-close {
      position: absolute; top: 8px; right: 8px;
      width: 34px; height: 34px; border-radius: 10px;
      border: 1px solid rgba(255,255,255,0.25);
      background: rgba(255,255,255,0.06);
      display: inline-flex; align-items: center; justify-content: center;
      cursor: pointer;
    }
    .qr-close svg { width: 18px; height: 18px; stroke: #fff; fill: none; stroke-width: 2; }
    .qr-foot {
      margin-top: 10px; font-size: 12px; opacity: 0.7;
      word-break: break-all;
    }
  </style>
</head>
<body>
  <!-- Inline SVG icon set (no external deps) -->
  <svg aria-hidden="true" style="position:absolute;width:0;height:0;overflow:hidden">
    <defs>
      <symbol id="i-video" viewBox="0 0 24 24" stroke-width="2">
        <rect x="2" y="6" width="14" height="12" rx="2" ry="2"></rect>
        <polygon points="18 8 22 10 22 14 18 16 18 8"></polygon>
      </symbol>
      <symbol id="i-camera" viewBox="0 0 24 24" stroke-width="2">
        <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h3l2-3h8l2 3h3a2 2 0 0 1 2 2z"></path>
        <circle cx="12" cy="13" r="4"></circle>
      </symbol>
      <symbol id="i-audio" viewBox="0 0 24 24" stroke-width="2">
        <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
        <path d="M19.07 4.93a10 10 0 0 1 0 14.14"></path>
        <path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path>
      </symbol>
      <symbol id="i-pose" viewBox="0 0 24 24" stroke-width="2">
        <circle cx="12" cy="5.5" r="2"></circle>
        <path d="M12 7.5v5.5"></path>
        <path d="M9 10l3 3 3-3"></path>
        <path d="M8 21l4-7 4 7"></path>
      </symbol>
      <symbol id="i-face" viewBox="0 0 24 24" stroke-width="2">
        <circle cx="12" cy="12" r="8.5"></circle>
        <path d="M9.25 10.5h.01M14.75 10.5h.01"></path>
        <path d="M9.5 14c1 .8 4 .8 5 0"></path>
      </symbol>
      <symbol id="i-settings" viewBox="0 0 24 24" stroke-width="2">
        <line x1="4" y1="21" x2="4" y2="14"></line>
        <line x1="4" y1="10" x2="4" y2="3"></line>
        <line x1="12" y1="21" x2="12" y2="12"></line>
        <line x1="12" y1="8" x2="12" y2="3"></line>
        <line x1="20" y1="21" x2="20" y2="16"></line>
        <line x1="20" y1="12" x2="20" y2="3"></line>
        <circle cx="4" cy="12" r="2"></circle>
        <circle cx="12" cy="10" r="2"></circle>
        <circle cx="20" cy="14" r="2"></circle>
      </symbol>
      <symbol id="i-help" viewBox="0 0 24 24" stroke-width="2">
        <circle cx="12" cy="12" r="10"></circle>
        <path d="M9.1 9a3 3 0 1 1 5.8 1c0 2-3 2-3 4"></path>
        <circle cx="12" cy="17" r="1"></circle>
      </symbol>
      <symbol id="i-invite" viewBox="0 0 24 24" stroke-width="2">
        <path d="M16 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
        <circle cx="12" cy="7" r="4"></circle>
        <line x1="20" y1="8" x2="20" y2="14"></line>
        <line x1="17" y1="11" x2="23" y2="11"></line>
      </symbol>
      <symbol id="i-contact" viewBox="0 0 24 24" stroke-width="2">
        <rect x="2" y="4" width="20" height="16" rx="2" ry="2"></rect>
        <path d="M22 6 12 13 2 6"></path>
      </symbol>
    </defs>
  </svg>

  <!-- Tiny hamburger (SVG so it renders reliably on iPhone) -->
  <button id="hamburger" aria-label="Open menu" aria-controls="sidebar" aria-expanded="false">
    <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
      <path d="M4 6.5H20M4 12H20M4 17.5H20"></path>
    </svg>
  </button>

  <!-- Sidebar -->
  <nav id="sidebar" aria-label="Main">
    <div class="menu">
      <!-- Home icon first; anchor navigates to Home. Icons referenced from same folder -->
      <a class="nav-item" href="/hungryface/home" data-item="home" aria-label="Home">
        <svg class="nav-icon" aria-hidden="true" focusable="false">
          <use href="icons.svg#icon-cradle-ai" xlink:href="icons.svg#icon-cradle-ai"></use>
        </svg>
        <span class="nav-label">Home</span>
      </a>

      <a class="nav-item" href="https://hungryfaceai.github.io/hungryface/webrtc/receiver/video/" data-item="video" aria-label="Video">
        <svg class="nav-icon"><use href="#i-video"/></svg><span class="nav-label">Video</span>
      </a>
      <!-- Removed: Camera -->
      <a class="nav-item" href="https://hungryfaceai.github.io/hungryface/webrtc/receiver/audio/" data-item="audio" aria-label="Audio">
        <svg class="nav-icon"><use href="#i-audio"/></svg><span class="nav-label">Audio</span>
      </a>
      <a class="nav-item" href="https://hungryfaceai.github.io/hungryface/webrtc/receiver/pose/" data-item="pose" aria-label="Pose">
        <svg class="nav-icon"><use href="#i-pose"/></svg><span class="nav-label">Pose</span>
      </a>
      <a class="nav-item" href="https://hungryfaceai.github.io/hungryface/webrtc/receiver/face/" data-item="face" aria-label="Face">
        <svg class="nav-icon"><use href="#i-face"/></svg><span class="nav-label">Face</span>
      </a>
      <a class="nav-item" href="https://hungryfaceai.github.io/hungryface/webrtc/receiver/settings/" data-item="settings" aria-label="Settings">
        <svg class="nav-icon"><use href="#i-settings"/></svg><span class="nav-label">Settings</span>
      </a>
      <a class="nav-item" href="https://hungryfaceai.github.io/hungryface/webrtc/receiver/help/" data-item="help" aria-label="Help">
        <svg class="nav-icon"><use href="#i-help"/></svg><span class="nav-label">Help</span>
      </a>
      <!-- Invite opens QR modal -->
      <button class="nav-item" data-item="invite" aria-label="Invite a friend">
        <svg class="nav-icon"><use href="#i-invite"/></svg><span class="nav-label">Invite a friend</span>
      </button>
      <button class="nav-item" data-item="contact" aria-label="Contact us">
        <svg class="nav-icon"><use href="#i-contact"/></svg><span class="nav-label">Contact us</span>
      </button>
    </div>
  </nav>

  <!-- Invite QR Modal -->
  <div id="qrModal" role="dialog" aria-modal="true" aria-labelledby="qrTitle">
    <div class="qr-card">
      <button class="qr-close" id="qrClose" aria-label="Close invite dialog">
        <svg viewBox="0 0 24 24"><path d="M6 6L18 18M18 6L6 18"/></svg>
      </button>
      <h3 class="qr-title" id="qrTitle">Invite a friend</h3>
      <p class="qr-sub">Scan the QR with your phoneâ€™s camera to open the link.</p>
      <div id="qrContainer" aria-label="QR code"></div>
      <div class="qr-actions">
        <button id="copyInvite">Copy link</button>
        <a id="openInvite" target="_blank" rel="noopener">Open</a>
        <button id="shareInvite" style="display:none;">Shareâ€¦</button>
      </div>
      <div class="qr-foot" id="inviteUrlText"></div>
    </div>
  </div>

  <script>
    // ---------------- QRCode.js (MIT) - embedded minimal generator ----------------
    /*! qrcode.js v1.0.0 (MIT) | https://github.com/davidshimjs/qrcodejs */
    /* Minified for brevity */
    !function(o){function p(a){this.mode=s.MODE_8BIT_BYTE,this.data=a}function q(a,c){this.typeNumber=a,this.errorCorrectLevel=c,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}function r(a,c){if(void 0==a.length)throw new Error(a.length+"/"+c);for(var b=0;b<a.length&&0==a[b];)b++;this.num=a.length-b;for(var d=Array(this.num),e=0;e<this.num;e++)d[e]=a[e+b];this.den=c}function t(a,c){this.totalCount=a,this.dataCount=c}var s={};p.prototype={getLength:function(){return this.data.length},write:function(a){for(var c=0;c<this.data.length;c++){var b=this.data.charCodeAt(c);a.put(b,8)}}};q.prototype={addData:function(a){this.dataList.push(new p(a)),this.dataCache=null},isDark:function(a,c){if(0>a||this.moduleCount<=a||0>c||this.moduleCount<=c)throw new Error(a+","+c);return this.modules[a][c]},getModuleCount:function(){return this.moduleCount},make:function(){if(this.typeNumber<1){for(var a=1;a<40;a++){for(var c=t.getRSBlocks(a,this.errorCorrectLevel),b=new u,d=0,e=0;e<c.length;e++)d+=c[e].dataCount;for(e=0;e<this.dataList.length;e++)b.put(4,4),b.put(this.dataList[e].getLength(),8),this.dataList[e].write(b);for(e=0;e<c.length;e++)if(b.getLengthInBits()<=8*d){this.typeNumber=a;break}if(this.typeNumber!=a)continue;break}}this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(a,c){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var b=0;b<this.moduleCount;b++){this.modules[b]=new Array(this.moduleCount);for(var d=0;d<this.moduleCount;d++)this.modules[b][d]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(a,c),this.typeNumber>=7&&this.setupTypeNumber(a);var e=t.getRSBlocks(this.typeNumber,this.errorCorrectLevel),f=new u;for(b=0;b<this.dataList.length;b++)f.put(4,4),f.put(this.dataList[b].getLength(),8),this.dataList[b].write(f);var g=0;for(b=0;b<e.length;b++)g+=e[b].dataCount;f.getLengthInBits()>8*g&&console.error("qrcode: data overflow");for(f=f.makeBytes(),b=0;b<e.length;b++){var h=e[b].dataCount,k=e[b].totalCount-h;for(a=Array(h),d=0;d<a.length;d++)a[d]=255&f[d];f=f.slice(h);var l=v.getErrorCorrectPolynomial(k),m=new r(a,l.getAt(0));for(d=1;d<k;d++)m=m.multiplyMod(new r([0],l.getAt(d)));var n=m.getResult(k);for(d=0;d<k;d++)a.push(n[d]);this.dataCache?this.dataCache=this.dataCache.concat(a):this.dataCache=a}this.mapData(this.dataCache,c)},setupPositionProbePattern:function(a,c){for(var b=-1;7>=b;b++)if(!(-1>=a+b||this.moduleCount<=a+b))for(var d=-1;7>=d;d++)-1>=c+d||this.moduleCount<=c+d||(this.modules[a+b][c+d]=0<=b&&b<=6&&(0==d||6==d)||0<=d&&d<=6&&(0==b||6==b)||2<=b&&b<=4&&2<=d&&d<=4)},getBestMaskPattern:function(){for(var a=0,c=0,b=0;8>b;b++){this.makeImpl(!0,b);var d=w.getLostPoint(this);(0==b||a>d)&&(a=d,c=b)}return c},createMovieClip:function(a,c,b){a=a.createEmptyMovieClip(c,b),this.make(),for(c=0;c<this.modules.length;c++)for(var d=1*c,b=0;b<this.modules[c].length;b++){var e=1*b;this.modules[c][b]&&(a.beginFill(0,100),a.moveTo(e,d),a.lineTo(e+1,d),a.lineTo(e+1,d+1),a.lineTo(e,d+1),a.endFill())}return a},setupTimingPattern:function(){for(var a=8;a<this.moduleCount-8;a++)null==this.modules[a][6]&&(this.modules[a][6]=0==a%2),null==this.modules[6][a]&&(this.modules[6][a]=0==a%2)},setupPositionAdjustPattern:function(){for(var a=v.getPatternPosition(this.typeNumber),c=0;c<a.length;c++)for(var b=0;b<a.length;b++){var d=a[c],e=a[b];if(null==this.modules[d][e])for(var f=-2;f<=2;f++)for(var g=-2;g<=2;g++)this.modules[d+f][e+g]=-2==f||2==f||-2==g||2==g||0==f&&0==g}},setupTypeNumber:function(a){for(var c=v.getBCHTypeNumber(this.typeNumber),b=0;b<18;b++){var d=!a&&1==(c>>b&1);this.modules[Math.floor(b/3)][b%3+this.moduleCount-8-3]=d}for(b=0;b<18;b++)d=!a&&1==(c>>b&1),this.modules[b%3+this.moduleCount-8-3][Math.floor(b/3)]=d},setupTypeInfo:function(a,c){for(var b=v.getBCHTypeInfo(c<<3|0),d=0;d<15;d++){var e=!a&&1==(b>>d&1);6>d?this.modules[d][8]=e:8>d?this.modules[d+1][8]=e:this.modules[this.moduleCount-15+d][8]=e}for(d=0;d<15;d++)e=!a&&1==(b>>d&1),8>d?this.modules[8][this.moduleCount-d-1]=e:9>d?this.modules[8][15-d-1]=e:this.modules[8][15-d-1]=e;this.modules[this.moduleCount-8][8]=!a},mapData:function(a,c){for(var b=-1,d=this.moduleCount-1,e=7,f=0,g=this.moduleCount-1;0<g;g-=2){6==g&&g--;for(;;){for(var h=0;2>h;h++)if(null==this.modules[d][g-h]){var k=!1;f<a.length&&(k=1==(a[f]>>>e&1));var l=v.getMask(c,d,g-h);this.modules[d][g-h]=l?!k:k;e--; -1==e&&(f++,e=7)}d+=b;if(0>d||this.moduleCount<=d){d-=b;b=-b;break}}}},u=function(){this.buffer=[],this.length=0};u.prototype={getBuffer:function(){return this.buffer},getLengthInBits:function(){return this.length},put:function(a,c){for(var b=0;b<c;b++)this.putBit(a>>c-b-1&1)},putBit:function(a){var c=Math.floor(this.length/8);this.buffer.length<=c&&this.buffer.push(0),a&&(this.buffer[c]|=128>>>this.length%8),this.length++},makeBytes:function(){return this.buffer}};r.prototype={getAt:function(a){return this.den[a]},getResult:function(a){for(var c=new Array(a),b=0;b<a;b++)c[b]=this.mod(0,a-1-b);return c},multiplyMod:function(a){for(var c=new Array(this.den.length+a.den.length-1),b=0;b<c.length;b++)c[b]=0;for(b=0;b<this.den.length;b++)for(var d=0;d<a.den.length;d++)c[b+d]^=v.gexp(v.glog(this.den[b])+v.glog(a.den[d]));return new r(c,this.den)},mod:function(a,c){for(var b=this.den.slice(),d=b.length-(this.den.length-this.num),e=0;e<a;e++)b.push(0);for(;b.length>c+1;){for(e=0;0==b[e];)e++;if(e>=b.length)break;var f=b[e];for(var g=0;g<this.den.length;g++)b[e+g]^=v.gexp(v.glog(f)+v.glog(this.den[g]))}return b}},v={glog:function(a){if(1>a)throw new Error("glog("+a+")");return v.LOG_TABLE[a]},gexp:function(a){for(;0>a;)a+=255;for(;256<=a;)a-=255;return v.EXP_TABLE[a]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256),getBCHTypeInfo:function(a){for(var c=a<<10;0<=v.getBCHDigit(c)-v.getBCHDigit(1335);)c^=1335<<v.getBCHDigit(c)-v.getBCHDigit(1335);return a<<10|c},getBCHTypeNumber:function(a){for(var c=a<<12;0<=v.getBCHDigit(c)-v.getBCHDigit(7973);)c^=7973<<v.getBCHDigit(c)-v.getBCHDigit(7973);return a<<12|c},getBCHDigit:function(a){for(var c=0;0!=a;)c++,a>>>=1;return c},getPatternPosition:function(a){return[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94]][a-1]||[]},getRSBlocks:function(a,c){var b=t.getRSBlocks(a,c);if(void 0==b)throw new Error("bad rs block @ typeNumber:"+a+"/errorCorrectLevel:"+c);return b},polyMultiply:function(a,c){for(var b=Array(a.length+c.length-1),d=0;d<b.length;d++)b[d]=0;for(d=0;d<a.length;d++)for(var e=0;e<c.length;e++)b[d+e]^=v.gexp(v.glog(a[d])+v.glog(c[e]));return b},polyMod:function(a,c){for(var b=a.slice(),d=b.length-(c.length-1),e=0;e<d;e++){for(var f=0;0==b[f];)f++;if(f>=b.length)break;for(var g=v.gexp(v.glog(b[f])),h=0;h<c.length;h++)b[f+h]^=v.gexp((v.glog(c[h])+g)%255)}return b}};for(var x=0;256>x;x++)v.EXP_TABLE[x]=x<8?1<<x:v.EXP_TABLE[x-1]^v.EXP_TABLE[x-4]^v.EXP_TABLE[x-5]^v.EXP_TABLE[x-8],v.LOG_TABLE[v.EXP_TABLE[x]]=x;var w={getLostPoint:function(a){for(var c=a.getModuleCount(),b=0,d=0;d<c;d++)for(var e=0;e<c;e++){for(var f=0,g=a.isDark(d,e),h=-1;1>=h;h++)if(!(0>d+h||c<=d+h))for(var k=-1;1>=k;k++)0>e+k||c<=e+k||0==h&&0==k||g==a.isDark(d+h,e+k)&&f++;4<f&&(b+=3+f-5)}for(d=0;d<c-1;d++)for(e=0;e<c-1;e++){var l=0;a.isDark(d,e)&&l++;a.isDark(d+1,e)&&l++;a.isDark(d,e+1)&&l++;a.isDark(d+1,e+1)&&l++;0==l||4==l&&(b+=3)}for(d=0;d<c;d++)for(e=0;e<c-6;e++)a.isDark(d,e)&&!a.isDark(d,e+1)&&a.isDark(d,e+2)&&a.isDark(d,e+3)&&a.isDark(d,e+4)&&!a.isDark(d,e+5)&&a.isDark(d,e+6)&&(b+=40);for(e=0;e<c;e++)for(d=0;d<c-6;d++)a.isDark(d,e)&&!a.isDark(d+1,e)&&a.isDark(d+2,e)&&a.isDark(d+3,e)&&a.isDark(d+4,e)&&!a.isDark(d+5,e)&&a.isDark(d+6,e)&&(b+=40);for(d=0;d<c;d++)for(e=0;e<c;e++)a.isDark(d,e)&&b++;return b+10*Math.abs(50-100*b/(c*c))}};t.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15]];t.getRSBlocks=function(a,c){var b=[];if(1>a||40<a)throw new Error("typeNumber:"+a);for(var d=t.RS_BLOCK_TABLE[4*(a-1)+c],e=0;e<d.length/3;e++)for(var f=0,g=d[3*e+0],h=d[3*e+1],k=d[3*e+2];f<g;f++)b.push(new t(h,k));return b};var y={L:1,M:0,Q:3,H:2};window.QRCode=function(a,c){this._el="string"==typeof a?document.getElementById(a):a,this._htOption=c,this._oQRCode=null,this._oDrawing=null,this._htOption.width&&(this._htOption.height=this._htOption.width),this.makeCode(c.text)},QRCode.prototype.makeCode=function(a){this._oQRCode=new q(-1,y.M),this._oQRCode.addData(a),this._oQRCode.make(),this._el.innerHTML="";for(var c=this._oQRCode.getModuleCount(),b=Math.floor(Math.min(this._htOption.width||256,this._htOption.height||256)/c),d=b*c,e=document.createElement("canvas"),f=e.getContext("2d");e.width=e.height=d,f.clearRect(0,0,d,d),f.fillStyle="#000",f.fillRect(0,0,d,d),f.fillStyle="#fff",f.fillRect(0,0,d,d),f.fillStyle="#000",f.beginPath(),h=0;h<c;h++)for(var g=0;g<c;g++)this._oQRCode.isDark(h,g)&&f.fillRect(b*h,b*g,b,b);this._el.appendChild(e)},QRCode.CorrectLevel={L:1,M:0,Q:3,H:2};
  </script>

  <script>
    // Sidebar + hamburger
    const sidebar   = document.getElementById('sidebar');
    const hamburger = document.getElementById('hamburger');
    const navItems  = Array.from(sidebar.querySelectorAll('.nav-item'));

    // Detect touch (iPhone/iPad etc.)
    const isTouch = matchMedia('(pointer: coarse)').matches || 'ontouchstart' in window;

    // Auto-hide drawer (no dragger)
    const SIDEBAR_AUTOHIDE_MS = 10000;
    let sidebarTimer = null;

    function hideSidebar() {
      sidebar.classList.remove('visible');
      hamburger.classList.remove('hidden');         // show button when drawer closes
      hamburger.setAttribute('aria-expanded', 'false');
      clearTimeout(sidebarTimer); sidebarTimer = null;
      resetHamburgerFade();
    }
    function showSidebar() {
      sidebar.classList.add('visible');
      hamburger.classList.add('hidden');            // hide button entirely while open
      hamburger.setAttribute('aria-expanded', 'true');
      clearTimeout(sidebarTimer);
      sidebarTimer = setTimeout(hideSidebar, SIDEBAR_AUTOHIDE_MS);
    }
    function toggleSidebar() {
      if (sidebar.classList.contains('visible')) hideSidebar();
      else showSidebar();
    }

    // Click/tap outside the sidebar closes it (ignore clicks on hamburger)
    function clickOutsideHandler(e) {
      if (!sidebar.classList.contains('visible')) return;
      const insideSidebar   = e.target.closest('#sidebar');
      const insideHamburger = e.target.closest('#hamburger');
      if (!insideSidebar && !insideHamburger) hideSidebar();
    }
    document.addEventListener('pointerdown', clickOutsideHandler, { passive: true });
    document.addEventListener('click', clickOutsideHandler, { passive: true });

    // Hamburger auto-fade (disabled on touch so it's always visible there)
    const HAMBURGER_FADE_MS = 4000;
    let hamburgerFadeTimer = null;
    function showHamburger() {
      hamburger.classList.remove('faded');
      hamburger.setAttribute('aria-hidden', 'false');
    }
    function hideHamburgerBtn() {
      hamburger.classList.add('faded');
      hamburger.setAttribute('aria-hidden', 'true');
    }
    function resetHamburgerFade() {
      if (hamburger.classList.contains('hidden')) return; // don't touch while drawer open
      showHamburger();
      clearTimeout(hamburgerFadeTimer);
      if (isTouch) return; // keep visible on iPhone/iPad
      if (document.fullscreenElement) {
        hamburgerFadeTimer = setTimeout(() => {
          if (!sidebar.classList.contains('visible') && !hamburger.classList.contains('hidden')) {
            hideHamburgerBtn();
          }
        }, HAMBURGER_FADE_MS);
      } else {
        showHamburger(); // keep visible when not in fullscreen
      }
    }

    // Discoverability
    if (isTouch) { hideSidebar(); showHamburger(); } else { showSidebar(); }

    // Toggle via hamburger
    hamburger.addEventListener('click', (e) => {
      e.stopPropagation();
      toggleSidebar();
      resetHamburgerFade();
    });

    // Keep drawer open while interacting
    ['mousemove','pointermove','wheel','touchstart','click','keydown'].forEach(ev =>
      sidebar.addEventListener(ev, () => {
        clearTimeout(sidebarTimer);
        sidebarTimer = setTimeout(hideSidebar, SIDEBAR_AUTOHIDE_MS);
      }, { passive: true })
    );

    // Global activity revives hamburger (mainly in fullscreen)
    ['mousemove','pointermove','touchstart','keydown','click'].forEach(ev =>
      window.addEventListener(ev, () => resetHamburgerFade(), { passive: true })
    );

    // Close drawer with Escape
    window.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') hideSidebar();
    });

    // ---------- Menu interactions (sidebar-only) ----------
    function setActive(itemName) {
      navItems.forEach(btn => btn.classList.toggle('active', btn.dataset.item === itemName));
    }

    sidebar.addEventListener('click', (e) => {
      const btn = e.target.closest('.nav-item');
      if (!btn) return;
      const item = btn.dataset.item;
      setActive(item);
      console.log('[SIDEBAR] Selected:', item);
      clearTimeout(sidebarTimer);
      sidebarTimer = setTimeout(hideSidebar, SIDEBAR_AUTOHIDE_MS);
    });

    // Cleanup timers on unload
    window.addEventListener('beforeunload', () => {
      clearTimeout(sidebarTimer);
      clearTimeout(hamburgerFadeTimer);
    });

    // ---------------- Invite QR logic ----------------
    const INVITE_URL = 'https://hungryfaceai.github.io/hungryface/home/';

    const qrModal = document.getElementById('qrModal');
    const qrClose = document.getElementById('qrClose');
    const qrContainer = document.getElementById('qrContainer');
    const copyInvite = document.getElementById('copyInvite');
    const openInvite = document.getElementById('openInvite');
    const shareInvite = document.getElementById('shareInvite');
    const inviteUrlText = document.getElementById('inviteUrlText');

    // Fill static parts
    openInvite.href = INVITE_URL;
    inviteUrlText.textContent = INVITE_URL;

    const inviteBtn = sidebar.querySelector('.nav-item[data-item="invite"]');
    inviteBtn.addEventListener('click', (e) => {
      e.preventDefault();
      showInviteQR();
    });

    function showInviteQR() {
      // Clear any previous QR
      qrContainer.innerHTML = '';
      // Generate QR (canvas)
      new QRCode(qrContainer, { text: INVITE_URL, width: 240, height: 240 });
      qrModal.classList.add('visible');

      // Share API availability
      if (navigator.share) {
        shareInvite.style.display = '';
      } else {
        shareInvite.style.display = 'none';
      }
    }
    function hideInviteQR() {
      qrModal.classList.remove('visible');
    }

    qrClose.addEventListener('click', hideInviteQR);
    qrModal.addEventListener('click', (e) => {
      if (e.target === qrModal) hideInviteQR(); // click on backdrop
    });
    window.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && qrModal.classList.contains('visible')) hideInviteQR();
    });

    copyInvite.addEventListener('click', async () => {
      try {
        await navigator.clipboard.writeText(INVITE_URL);
        copyInvite.textContent = 'Copied!';
        setTimeout(() => (copyInvite.textContent = 'Copy link'), 1200);
      } catch {
        copyInvite.textContent = 'Copy failed';
        setTimeout(() => (copyInvite.textContent = 'Copy link'), 1200);
      }
    });

    shareInvite.addEventListener('click', async () => {
      try {
        await navigator.share({ title: 'Naptio', text: 'Join me on Naptio', url: INVITE_URL });
      } catch { /* user cancelled */ }
    });
  </script>
</body>
</html>
